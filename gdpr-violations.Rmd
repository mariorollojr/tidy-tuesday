---
title: "GDPR Violations"
author: "Alex Cookson"
date: "20/04/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup-and-import}
library(tidyverse)
library(lubridate)
library(scales)

gdpr_violations <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-04-21/gdpr_violations.tsv')
gdpr_text <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-04-21/gdpr_text.tsv')
```

```{r}
gdpr_violations %>%
  ggplot(aes(price)) +
  geom_histogram() +
  scale_x_log10(labels = label_dollar())

gdpr_violations %>%
  group_by(controller) %>%
  summarise(violations = n(),
            fines = sum(price)) %>%
  top_n(10, wt = fines) %>%
  mutate(controller = fct_reorder(controller, fines)) %>%
  ggplot(aes(fines, controller, fill = controller)) +
  geom_col() +
  scale_x_continuous(labels = label_dollar(scale = 1/1e6, prefix = "â‚¬", suffix = " M")) +
  theme(legend.position = "none")
```


